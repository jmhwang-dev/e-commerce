table_name: order_product_latest_group
main_dttm_col: null
description: null
default_endpoint: null
offset: 0
cache_timeout: null
catalog: warehousedev
schema: gold
sql: "with LatestProductPorfolioGroup as (\n  select\n  product_id,\n  group,\n  rank()\
  \ over(partition by product_id order by sales_period desc) as rnk\n  from gold.batch.fact_monthly_sales_by_product\n\
  )\n\nselect\nod.product_id,\nod.order_id,\nod.customer_id,\nod.seller_id,\nod.category,\n\
  od.quantity,\nod.unit_price,\nlg.group as latest_group\nfrom gold.batch.fact_order_detail\
  \ od\nleft join (\nselect *\nfrom LatestProductPorfolioGroup\nwhere rnk = 1) lg\n\
  using(product_id)"
params: null
template_params: null
filter_select_enabled: true
fetch_values_predicate: null
extra: null
normalize_columns: false
always_filter_main_dttm: false
uuid: 40dab393-3b50-44b9-8a55-22e80484c346
metrics:
- metric_name: count
  verbose_name: COUNT(*)
  metric_type: count
  expression: COUNT(*)
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
columns:
- column_name: group_styled
  verbose_name: null
  is_dttm: false
  is_active: true
  type: null
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: "CASE\n    WHEN latest_group = 'Star Products' THEN '<div style=\"background-color:\
    \ #FFD700; color: black; padding: 5px; border-radius: 5px; text-align: center;\
    \ font-weight: bold;\">\U0001F7E1 Star Products</div>'\n    WHEN latest_group\
    \ = 'Volume Drivers' THEN '<div style=\"background-color: #87CEFA; color: black;\
    \ padding: 5px; border-radius: 5px; text-align: center; font-weight: bold;\">\U0001F535\
    \ Volume Drivers</div>'\n    WHEN latest_group = 'Niche Gems' THEN '<div style=\"\
    background-color: #DDA0DD; color: black; padding: 5px; border-radius: 5px; text-align:\
    \ center; font-weight: bold;\">\U0001F7E3 Niche Gems</div>'\n    ELSE '<div style=\"\
    background-color: #D3D3D3; color: black; padding: 5px; border-radius: 5px; text-align:\
    \ center;\">\u26AA Question Marks</div>'\nEND"
  description: null
  python_date_format: null
  extra: {}
- column_name: unit_price
  verbose_name: null
  is_dttm: false
  is_active: true
  type: FLOAT_TYPE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: quantity
  verbose_name: null
  is_dttm: false
  is_active: true
  type: BIGINT_TYPE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: latest_group
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING_TYPE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: product_id
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING_TYPE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: customer_id
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING_TYPE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: order_id
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING_TYPE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: seller_id
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING_TYPE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
- column_name: category
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING_TYPE
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: ''
  description: null
  python_date_format: null
  extra: {}
version: 1.0.0
database_uuid: 296ec29a-0751-45b3-a479-cbd6181bd787
